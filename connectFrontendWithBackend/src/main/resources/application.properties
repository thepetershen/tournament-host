spring.application.name=connect-frontend-with-backend

# PostgreSQL database configuration
# These values now come from .env file (or environment variables)
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}

# Hibernate Configuration
# Changed from 'update' to 'validate' for production safety
# Now Flyway handles all schema changes via migration files
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Flyway Database Migration Configuration
# Enables automatic database versioning and migration
spring.flyway.enabled=true
# Creates baseline at version 0 for existing databases (won't break your current data!)
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0
spring.flyway.baseline-description=Existing database baseline
# Location of migration SQL files
spring.flyway.locations=classpath:db/migration

# HikariCP Connection Pool Configuration (Production Safeguards)
# Maximum number of connections in the pool
spring.datasource.hikari.maximum-pool-size=10
# Maximum time (ms) to wait for a connection from the pool
spring.datasource.hikari.connection-timeout=30000
# Maximum time (ms) a connection can sit idle in the pool
spring.datasource.hikari.idle-timeout=600000
# Maximum lifetime (ms) of a connection in the pool
spring.datasource.hikari.max-lifetime=1800000
# Minimum number of idle connections maintained
spring.datasource.hikari.minimum-idle=5
# Connection leak detection threshold (ms) - logs if connection not returned
spring.datasource.hikari.leak-detection-threshold=60000

# Server port configuration
server.port=${SERVER_PORT:8080}

# Server Connection & Timeout Configuration (Production Safeguards)
# Maximum time (ms) the server will wait for request/response
server.connection-timeout=60000
# Maximum time (ms) for async request processing
spring.mvc.async.request-timeout=30000
# Tomcat thread pool configuration
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10
# Maximum number of connections server will accept
server.tomcat.max-connections=10000
# Maximum size of HTTP request header
server.max-http-request-header-size=20KB

# JWT Security Configuration
# IMPORTANT: These secrets are loaded from .env file (which is .gitignored)
# Never commit actual secret values to git!
security.jwt.secret-key=${JWT_SECRET_KEY}
security.jwt.expiration-time=${JWT_EXPIRATION_TIME:3600000}

# Email Configuration (SendGrid SMTP)
spring.mail.host=smtp.sendgrid.net
spring.mail.port=587
spring.mail.username=apikey
spring.mail.password=${SENDGRID_API_KEY}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true

# Application URL for email links
app.frontend.url=${FRONTEND_URL:http://localhost:5173}